import{a7 as d,S as y,i as E,s as S,e as v,t as f,c as x,a as C,g as p,d as h,b as m,f as g,E as T,h as P,l as b,M as j,_ as A}from"../../../../chunks/vendor-ab4be69b.js";import{u as i,g as F,S as G}from"../../../../chunks/cookies-d7879264.js";import{i as O}from"../../../../chunks/utils-6e4fb32a.js";let l={};function k(r,t,n,s=!1){console.log("fetch_wraper: ",r);let e={"Content-Type":"application/json","Content-Type":"application/json; charset=UTF-8"};t&&t.method=="POST"&&(e["X-CSRFToken"]=F("csrftoken")),d(i).access&&(e.Authorization="Token "+d(i).access);var a=new Headers(e);t=Object.assign({},{method:"GET",mode:"cors",credentials:"include",headers:a,redirect:"follow"},t);let o;try{o=n?n(r,t):fetch(r,t)}catch(c){console.error(c)}return o.then(c=>{if(c.status==401){let u=d(i);if(u.isLogin=!1,u.access=null,i.set(u),!s)return k(r,t,n,!0)}return console.log(r," ==> ",c.status),c.json()}).then(c=>c)}function _(r,t,n){const s=r.slice();return s[1]=t[n],s}function w(r){let t,n,s,e,a=r[1].id+"";return{c(){t=v("a"),n=f("Product "),s=f(a),this.h()},l(o){t=x(o,"A",{href:!0});var c=C(t);n=p(c,"Product "),s=p(c,a),c.forEach(h),this.h()},h(){m(t,"href",e="./products/"+r[1].id+"/")},m(o,c){g(o,t,c),T(t,n),T(t,s)},p(o,c){1&c&&a!==(a=o[1].id+"")&&P(s,a),1&c&&e!==(e="./products/"+o[1].id+"/")&&m(t,"href",e)},d(o){o&&h(t)}}}function $(r){let t,n=r[0],s=[];for(let e=0;e<n.length;e+=1)s[e]=w(_(r,n,e));return{c(){for(let e=0;e<s.length;e+=1)s[e].c();t=b()},l(e){for(let a=0;a<s.length;a+=1)s[a].l(e);t=b()},m(e,a){for(let o=0;o<s.length;o+=1)s[o].m(e,a);g(e,t,a)},p(e,[a]){if(1&a){let o;for(n=e[0],o=0;o<n.length;o+=1){const c=_(e,n,o);s[o]?s[o].p(c,a):(s[o]=w(c),s[o].c(),s[o].m(t.parentNode,t))}for(;o<s.length;o+=1)s[o].d(1);s.length=n.length}},i:j,o:j,d(e){A(s,e),e&&h(t)}}}async function N({page:r,fetch:t,session:n,contex:s}){if(O(r.params.id))return{props:{products:await function(e,a){if(l[e])return l[e];{let o=k(G+"/_get_album_images/"+e,{method:"GET"},a);return l[e]=o,l[e]}}(r.params.id,t)}}}function z(r,t,n){let{products:s}=t;return r.$$set=e=>{"products"in e&&n(0,s=e.products)},[s]}class R extends y{constructor(t){super(),E(this,t,z,$,S,{products:0})}}export{R as default,N as load};
