import{a7 as d,S as v,i as y,s as E,e as S,t as f,c as x,a as A,g as p,d as h,b as m,f as g,E as w,h as C,l as T,M as j,_ as P,A as F}from"../../../../chunks/vendor-17410082.js";import{u as i,g as G,S as O}from"../../../../chunks/cookies-1167fb71.js";import{i as $}from"../../../../chunks/utils-05ad4441.js";let l={};function k(r,t,n,s=!1){console.log("fetch_wraper: ",r);let e={"Content-Type":"application/json","Content-Type":"application/json; charset=UTF-8"};t&&t.method=="POST"&&(e["X-CSRFToken"]=G("csrftoken")),d(i).access&&(e.Authorization="Token "+d(i).access);var a=new Headers(e);t=Object.assign({},{method:"GET",mode:"cors",credentials:"include",headers:a,redirect:"follow"},t);let o;try{o=n?n(r,t):fetch(r,t)}catch(c){console.error(c)}return o.then(c=>{if(c.status==401){let u=d(i);if(u.isLogin=!1,u.access=null,i.set(u),!s)return k(r,t,n,!0)}return console.log(r," ==> ",c.status),c.json()}).then(c=>c)}function _(r,t,n){const s=r.slice();return s[1]=t[n],s}function b(r){let t,n,s,e,a=r[1].id+"";return{c(){t=S("a"),n=f("Product "),s=f(a),this.h()},l(o){t=x(o,"A",{href:!0});var c=A(t);n=p(c,"Product "),s=p(c,a),c.forEach(h),this.h()},h(){m(t,"href",e="./products/"+r[1].id+"/")},m(o,c){g(o,t,c),w(t,n),w(t,s)},p(o,c){1&c&&a!==(a=o[1].id+"")&&C(s,a),1&c&&e!==(e="./products/"+o[1].id+"/")&&m(t,"href",e)},d(o){o&&h(t)}}}function z(r){let t,n=r[0],s=[];for(let e=0;e<n.length;e+=1)s[e]=b(_(r,n,e));return{c(){for(let e=0;e<s.length;e+=1)s[e].c();t=T()},l(e){for(let a=0;a<s.length;a+=1)s[a].l(e);t=T()},m(e,a){for(let o=0;o<s.length;o+=1)s[o].m(e,a);g(e,t,a)},p(e,[a]){if(1&a){let o;for(n=e[0],o=0;o<n.length;o+=1){const c=_(e,n,o);s[o]?s[o].p(c,a):(s[o]=b(c),s[o].c(),s[o].m(t.parentNode,t))}for(;o<s.length;o+=1)s[o].d(1);s.length=n.length}},i:j,o:j,d(e){P(s,e),e&&h(t)}}}async function R({page:r,fetch:t,session:n,contex:s}){if($(r.params.id))return{props:{products:await function(e,a){if(l[e])return l[e];{let o=k(O+"/_get_album_images/"+e,{method:"GET"},a);return l[e]=o,l[e]}}(r.params.id,t)}}}function H(r,t,n){let{products:s}=t;return F(()=>{var e=window.location.href;e=e.replace("/products",""),window.location.replace(e)}),r.$$set=e=>{"products"in e&&n(0,s=e.products)},[s]}class U extends v{constructor(t){super(),y(this,t,H,z,E,{products:0})}}export{U as default,R as load};
