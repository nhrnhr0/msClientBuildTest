import{az as d,S as y,i as E,s as _,e as x,t as f,c as A,a as C,g as p,d as h,b as m,f as g,E as k,h as O,l as w,O as T,$ as P,A as S}from"../../../../chunks/vendor-c667ba6d.js";import{u as i,k as $,m as z}from"../../../../chunks/cookies-43b1ac48.js";import{i as F}from"../../../../chunks/utils-05ad4441.js";let l={};function j(r,t,n,s=!1){console.log("fetch_wraper: ",r);let e={"Content-Type":"application/json","Content-Type":"application/json; charset=UTF-8"};t&&t.method=="POST"&&(e["X-CSRFToken"]=$("csrftoken")),d(i).access&&(e.Authorization="Token "+d(i).access);var a=new Headers(e);t=Object.assign({},{method:"GET",mode:"cors",credentials:"include",headers:a,redirect:"follow"},t);let o;try{o=n?n(r,t):fetch(r,t)}catch(c){console.error(c)}return o.then(c=>{if(c.status==401){let u=d(i);if(u.isLogin=!1,u.access=null,i.set(u),!s)return j(r,t,n,!0)}return console.log(r," ==> ",c.status),c.json()}).then(c=>c)}function b(r,t,n){const s=r.slice();return s[1]=t[n],s}function v(r){let t,n,s,e,a=r[1].id+"";return{c(){t=x("a"),n=f("Product "),s=f(a),this.h()},l(o){t=A(o,"A",{href:!0});var c=C(t);n=p(c,"Product "),s=p(c,a),c.forEach(h),this.h()},h(){m(t,"href",e="./products/"+r[1].id+"/")},m(o,c){g(o,t,c),k(t,n),k(t,s)},p(o,c){1&c&&a!==(a=o[1].id+"")&&O(s,a),1&c&&e!==(e="./products/"+o[1].id+"/")&&m(t,"href",e)},d(o){o&&h(t)}}}function G(r){let t,n=r[0],s=[];for(let e=0;e<n.length;e+=1)s[e]=v(b(r,n,e));return{c(){for(let e=0;e<s.length;e+=1)s[e].c();t=w()},l(e){for(let a=0;a<s.length;a+=1)s[a].l(e);t=w()},m(e,a){for(let o=0;o<s.length;o+=1)s[o].m(e,a);g(e,t,a)},p(e,[a]){if(1&a){let o;for(n=e[0],o=0;o<n.length;o+=1){const c=b(e,n,o);s[o]?s[o].p(c,a):(s[o]=v(c),s[o].c(),s[o].m(t.parentNode,t))}for(;o<s.length;o+=1)s[o].d(1);s.length=n.length}},i:T,o:T,d(e){P(s,e),e&&h(t)}}}async function U({page:r,fetch:t,session:n,contex:s}){if(F(r.params.id))return{props:{products:await function(e,a){if(l[e])return l[e];{let o=j(z+"/_get_album_images/"+e,{method:"GET"},a);return l[e]=o,l[e]}}(r.params.id,t)}}}function H(r,t,n){let{products:s}=t;return S(()=>{var e=window.location.href;e=e.replace("/products",""),window.location.replace(e)}),r.$$set=e=>{"products"in e&&n(0,s=e.products)},[s]}class X extends y{constructor(t){super(),E(this,t,H,G,_,{products:0})}}export{X as default,U as load};
